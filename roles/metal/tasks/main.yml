---
# https://docs.ansible.com/ansible/latest/collections/kubernetes/core/index.html

- name: Download MetalLB manifests
  ansible.builtin.get_url:
    url: https://raw.githubusercontent.com/metallb/metallb/v0.15.2/config/manifests/metallb-native.yaml
    dest: /tmp/metallb-install.yaml
  
- name: Apply MetalLB YAML manifests
  kubernetes.core.k8s:
    src: /tmp/metallb-install.yaml
    state: present



- name: Copy MetalLB configuration
  ansible.builtin.copy:
    src: metallb-config.yaml
    dest: /tmp/metallb-config.yaml

- name: Apply MetalLB configuration
  kubernetes.core.k8s:
    src: /tmp/metallb-config.yaml
    state: present